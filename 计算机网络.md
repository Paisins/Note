# 计算机网络

## 一、网络体系分层

### 1.1 七层协议
1. 应用层：规定应用程序的数据格式
2. 表示层：
3. 会话层：
4. 传输层：建立"端口到端口"的通信
5. 网络层：ip协议
6. 数据链路层：电信号分组方式。
7. 物理层：传输电信号
### 1.2 四层协议

应用层
运输层
网络层
网络接口层

## 二、互联网协议
参考：
[互联网协议入门(一)](https://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html)

### 2.1 mac地址
> 每块网卡出厂的时候，都有一个全世界独一无二的MAC地址，长度是48个二进制位，通常用12个十六进制数表示。
> MAC地址有局限性，如果两台电脑不在同一个子网络，就无法知道对方的MAC地址，必须通过网关（gateway）转发

### 2.2 数据链路层
以太网规定
>"标头"包含数据包的一些说明项，比如发送者、接受者、数据类型等等；"数据"则是数据包的具体内容。
"标头"的长度，固定为18字节。"数据"的长度，最短为46字节，最长为1500字节。因此，整个"帧"最短为64字节，最长为1518字节。如果数据很长，就必须分割成多个帧进行发送。

### 2.3 广播
> 就算有了MAC地址，系统怎样才能把数据包准确送到接收方？
回答是以太网采用了一种很"原始"的方式，它不是把数据包准确送到接收方，而是向本网络内所有计算机发送，让每台计算机自己判断，是否为接收方。

### 2.4 ip地址
> IP协议的作用主要有两个，一个是为每一台计算机分配IP地址，另一个是确定哪些地址在同一个子网络。
> 知道"子网掩码"，我们就能判断，任意两个IP地址是否处在同一个子网络。方法是将两个IP地址与子网掩码分别进行AND运算（两个数位都为1，运算结果为1，否则为0）
> 回答是不需要，我们可以把IP数据包直接放进以太网数据包的"数据"部分，因此完全不用修改以太网的规格。这就是互联网分层结构的好处：上层的变动完全不涉及下层的结构。

### 2.5 arp协议
> 总之，有了ARP协议之后，我们就可以得到同一个子网络内的主机MAC地址，可以把数据包发送到任意一台主机之上了。

### 2.6 传输层
> "传输层"的功能，就是建立"端口到端口"的通信。相比之下，"网络层"的功能是建立"主机到主机"的通信。只要确定主机和端口，我们就能实现程序之间的交流。

### 2.7 UDP协议
> 必须在数据包中加入端口信息，这就需要新的协议。最简单的实现叫做UDP协议
UDP协议的优点是比较简单，容易实现，但是缺点是可靠性较差，一旦数据包发出，无法知道对方是否收到。

### 2.8 TCP协议
> TCP协议能够确保数据不会遗失。它的缺点是过程复杂、实现困难、消耗较多的资源。
> TCP数据包和UDP数据包一样，都是内嵌在IP数据包的"数据"部分。TCP数据包没有长度限制，理论上可以无限长，但是为了保证网络的效率，通常TCP数据包的长度不会超过IP数据包的长度，以确保单个TCP数据包不必再分割。

### 2.9 应用层
> TCP协议可以为各种各样的程序传递数据，比如Email、WWW、FTP等等。那么，必须有不同协议规定电子邮件、网页、FTP数据的格式，这些应用程序协议就构成了"应用层"。

## 三、 socket

参考：
[理解socket](https://blog.csdn.net/StromMaybin/article/details/73010280)
[python socket编程](https://keelii.com/2018/09/24/socket-programming-in-python/)

```

```

为什么需要掌握socket编程？

## 四、tcp建立连接和断开
参考：
[TCP的三次握手与四次挥手理解及面试题](https://blog.csdn.net/qq_38950316/article/details/81087809)
[TCP报文格式](https://www.cnblogs.com/aspirant/p/7224696.html)


### 三次握手

- 客户端-服务端：发送syn（同步序列编号）包，序列号为j，进入syn_sent状态
- 服务端-客户端：发送syn包（k）和ack包（j+1），进入syn_recv状态
- 客户端-服务端：发送ack包（k+1），双方进入连接建立的状态

### 四次挥手

- 主动关闭方-被动关闭方：发送一个fin包，我就要关闭连接了
- 被动关闭方-主动关闭方：发送一个ack包，表明已经收到了
- 被动关闭方-主动关闭方：发送-个fin包，我也要关闭了
- 主动关闭方-被动关闭方：发送一个ack包，好的，都进入关闭的状态

报文结构：(flag='ACK', ACK=1)，(flag='SYN', SYN=1)

假使双方同时关闭呢？假使服务端提出关闭也是一样的吗？